"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@tiptap/core"),e=require("@tiptap/pm/state");const n=t.Node.create({name:"detailsContent",content:"block+",defining:!0,selectable:!1,addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:`div[data-type="${this.name}"]`}]},renderHTML({HTMLAttributes:e}){return["div",t.mergeAttributes(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},addNodeView(){return({HTMLAttributes:e})=>{const n=document.createElement("div"),r=t.mergeAttributes(this.options.HTMLAttributes,e,{"data-type":this.name,hidden:"hidden"});return Object.entries(r).forEach((([t,e])=>n.setAttribute(t,e))),n.addEventListener("toggleDetailsContent",(()=>{n.toggleAttribute("hidden")})),{dom:n,contentDOM:n,ignoreMutation:t=>"selection"!==t.type&&(!n.contains(t.target)||n===t.target),update:t=>t.type===this.type}}},addKeyboardShortcuts(){return{Enter:({editor:n})=>{const{state:r,view:i}=n,{selection:o}=r,{$from:d,empty:s}=o,a=t.findParentNode((t=>t.type===this.type))(o);if(!s||!a||!a.node.childCount)return!1;const c=d.index(a.depth),{childCount:u}=a.node;if(!(u===c+1))return!1;const l=a.node.type.contentMatch.defaultType,p=null==l?void 0:l.createAndFill();if(!p)return!1;const h=r.doc.resolve(a.pos+1),f=u-1,A=a.node.child(f),b=h.posAtIndex(f,a.depth);if(!A.eq(p))return!1;const y=d.node(-3);if(!y)return!1;const m=d.indexAfter(-3),M=t.defaultBlockAt(y.contentMatchAt(m));if(!M||!y.canReplaceWith(m,m,M))return!1;const g=M.createAndFill();if(!g)return!1;const{tr:v}=r,L=d.after(-2);v.replaceWith(L,L,g);const T=v.doc.resolve(L),H=e.Selection.near(T,1);v.setSelection(H);const x=b,C=b+A.nodeSize;return v.delete(x,C),v.scrollIntoView(),i.dispatch(v),!0}}}});exports.DetailsContent=n,exports.default=n;
